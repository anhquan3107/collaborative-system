<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="Task Management - Collaborative System" />
    <meta name="author" content="" />
    <title>Task Management - Collaborative System</title>

    <!-- Custom fonts for this template-->
    <link
      href="vendor/fontawesome-free/css/all.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
      rel="stylesheet"
    />

    <!-- Custom styles for this template-->
    <link href="css/sb-admin-2.min.css" rel="stylesheet" />
    <style>
      .task-avatar {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        object-fit: cover;
      }

      .priority-high {
        border-left: 4px solid #e74a3b;
      }

      .priority-medium {
        border-left: 4px solid #f6c23e;
      }

      .priority-low {
        border-left: 4px solid #1cc88a;
      }

      .note-textarea {
        width: 100%;
        min-height: 80px;
        resize: vertical;
      }

      .note-display {
        max-width: 200px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      .note-display.expanded {
        white-space: normal;
        overflow: visible;
      }
    </style>
  </head>

  <body id="page-top">
    <!-- Page Wrapper -->
    <div id="wrapper">
      <!-- Sidebar -->
      <ul
        class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion"
        id="accordionSidebar"
      >
        <!-- Sidebar - Brand -->
        <a
          class="sidebar-brand d-flex align-items-center justify-content-center"
          href="index.html"
        >
          <div class="sidebar-brand-icon rotate-n-15">
            <i class="fas fa-laugh-wink"></i>
          </div>
          <div class="sidebar-brand-text mx-3">Collaborative System</div>
        </a>

        <!-- Divider -->
        <hr class="sidebar-divider my-0" />

        <!-- Nav Item - Dashboard -->
        <li class="nav-item">
          <a class="nav-link" href="index.html">
            <i class="fas fa-fw fa-tachometer-alt"></i>
            <span>Homepage</span>
          </a>
        </li>

        <!-- Divider -->
        <hr class="sidebar-divider" />

        <!-- Heading -->
        <div class="sidebar-heading">Collaboration</div>

        <!-- Nav Item - Projects -->
        <li class="nav-item">
          <a class="nav-link" href="project.html">
            <i class="fas fa-fw fa-project-diagram"></i>
            <span>Project</span>
          </a>
        </li>

        <!-- Nav Item - Tasks -->
        <li class="nav-item active">
          <a class="nav-link" href="tasks.html">
            <i class="fas fa-fw fa-tasks"></i>
            <span>Tasks</span>
          </a>
        </li>

        <!-- Nav Item - Team -->
        <li class="nav-item">
          <a class="nav-link" href="team.html">
            <i class="fas fa-fw fa-users"></i>
            <span>Team</span>
          </a>
        </li>

        <!-- Divider -->
        <hr class="sidebar-divider" />

        <!-- Heading -->
        <div class="sidebar-heading">Authentication</div>

        <!-- Nav Item - Forgot Password -->
        <li class="nav-item">
          <a class="nav-link" href="forgot-password.html">
            <i class="fas fa-fw fa-key"></i>
            <span>Forgot Password</span>
          </a>
        </li>

        <!-- Divider -->
        <hr class="sidebar-divider d-none d-md-block" />

        <!-- Sidebar Toggler (Sidebar) -->
        <div class="text-center d-none d-md-inline">
          <button class="rounded-circle border-0" id="sidebarToggle"></button>
        </div>
      </ul>
      <!-- End of Sidebar -->

      <!-- Content Wrapper -->
      <div id="content-wrapper" class="d-flex flex-column">
        <!-- Main Content -->
        <div id="content">
          <!-- Topbar -->
          <nav
            class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow"
          >
            <!-- Sidebar Toggle (Topbar) -->
            <button
              id="sidebarToggleTop"
              class="btn btn-link d-md-none rounded-circle mr-3"
            >
              <i class="fa fa-bars"></i>
            </button>

            <!-- Topbar Search -->
            <form
              class="d-none d-sm-inline-block form-inline mr-auto ml-md-3 my-2 my-md-0 mw-100 navbar-search"
            >
              <div class="input-group">
                <input
                  type="text"
                  class="form-control bg-light border-0 small"
                  placeholder="Search for tasks..."
                  aria-label="Search"
                  aria-describedby="basic-addon2"
                />
                <div class="input-group-append">
                  <button class="btn btn-primary" type="button">
                    <i class="fas fa-search fa-sm"></i>
                  </button>
                </div>
              </div>
            </form>

            <!-- Topbar Navbar -->
            <ul class="navbar-nav ml-auto">
              <!-- Nav Item - Alerts -->
              <li class="nav-item dropdown no-arrow mx-1">
                <a
                  class="nav-link dropdown-toggle"
                  href="#"
                  id="alertsDropdown"
                  role="button"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                >
                  <i class="fas fa-bell fa-fw"></i>
                  <!-- Counter - Alerts -->
                  <span class="badge badge-danger badge-counter">3</span>
                </a>
              </li>

              <div class="topbar-divider d-none d-sm-block"></div>

              <!-- Nav Item - User Information -->
              <li class="nav-item dropdown no-arrow">
                <a
                  class="nav-link dropdown-toggle"
                  href="#"
                  id="userDropdown"
                  role="button"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                >
                  <span class="mr-2 d-none d-lg-inline text-gray-600 small"
                    >Alex Johnson</span
                  >
                  <img
                    class="img-profile rounded-circle"
                    src="https://source.unsplash.com/QAB-WJcbgJk/60x60"
                  />
                </a>
              </li>
            </ul>
          </nav>
          <!-- End of Topbar -->

          <!-- Begin Page Content -->
          <div class="container-fluid">
            <!-- Page Heading -->
            <div
              class="d-sm-flex align-items-center justify-content-between mb-4"
            >
              <h1 class="h3 mb-0 text-gray-800">Task Management</h1>
              <button
                class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"
                data-toggle="modal"
                data-target="#createTaskModal"
              >
                <i class="fas fa-plus fa-sm text-white-50"></i> Create New Task
              </button>
            </div>

            <!-- Content Row -->
            <div class="row">
              <!-- Task Statistics -->
              <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-primary shadow h-100 py-2">
                  <div class="card-body">
                    <div class="row no-gutters align-items-center">
                      <div class="col mr-2">
                        <div
                          class="text-xs font-weight-bold text-primary text-uppercase mb-1"
                        >
                          Total Tasks
                        </div>
                        <div
                          class="h5 mb-0 font-weight-bold text-gray-800"
                          id="totalTasks"
                        >
                          0
                        </div>
                      </div>
                      <div class="col-auto">
                        <i class="fas fa-tasks fa-2x text-gray-300"></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-success shadow h-100 py-2">
                  <div class="card-body">
                    <div class="row no-gutters align-items-center">
                      <div class="col mr-2">
                        <div
                          class="text-xs font-weight-bold text-success text-uppercase mb-1"
                        >
                          Completed
                        </div>
                        <div
                          class="h5 mb-0 font-weight-bold text-gray-800"
                          id="completedTasks"
                        >
                          0
                        </div>
                      </div>
                      <div class="col-auto">
                        <i class="fas fa-check-circle fa-2x text-gray-300"></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-warning shadow h-100 py-2">
                  <div class="card-body">
                    <div class="row no-gutters align-items-center">
                      <div class="col mr-2">
                        <div
                          class="text-xs font-weight-bold text-warning text-uppercase mb-1"
                        >
                          In Progress
                        </div>
                        <div
                          class="h5 mb-0 font-weight-bold text-gray-800"
                          id="inProgressTasks"
                        >
                          0
                        </div>
                      </div>
                      <div class="col-auto">
                        <i class="fas fa-spinner fa-2x text-gray-300"></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-danger shadow h-100 py-2">
                  <div class="card-body">
                    <div class="row no-gutters align-items-center">
                      <div class="col mr-2">
                        <div
                          class="text-xs font-weight-bold text-danger text-uppercase mb-1"
                        >
                          Overdue
                        </div>
                        <div
                          class="h5 mb-0 font-weight-bold text-gray-800"
                          id="overdueTasks"
                        >
                          0
                        </div>
                      </div>
                      <div class="col-auto">
                        <i
                          class="fas fa-exclamation-triangle fa-2x text-gray-300"
                        ></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Content Row -->
            <div class="row">
              <div class="col-lg-12">
                <!-- Task Filters -->
                <div class="card shadow mb-4">
                  <div
                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between"
                  >
                    <h6 class="m-0 font-weight-bold text-primary">
                      Task Filters
                    </h6>
                  </div>
                  <div class="card-body">
                    <div
                      class="btn-group btn-group-toggle"
                      data-toggle="buttons"
                    >
                      <label class="btn btn-outline-primary active">
                        <input
                          type="radio"
                          name="statusFilter"
                          id="all"
                          autocomplete="off"
                          checked
                        />
                        All
                      </label>
                      <label class="btn btn-outline-primary">
                        <input
                          type="radio"
                          name="statusFilter"
                          id="todo"
                          autocomplete="off"
                        />
                        To Do
                      </label>
                      <label class="btn btn-outline-primary">
                        <input
                          type="radio"
                          name="statusFilter"
                          id="inprogress"
                          autocomplete="off"
                        />
                        In Progress
                      </label>
                      <label class="btn btn-outline-primary">
                        <input
                          type="radio"
                          name="statusFilter"
                          id="review"
                          autocomplete="off"
                        />
                        Review
                      </label>
                      <label class="btn btn-outline-primary">
                        <input
                          type="radio"
                          name="statusFilter"
                          id="done"
                          autocomplete="off"
                        />
                        Done
                      </label>
                    </div>
                  </div>
                </div>

                <!-- Task List -->
                <div class="card shadow mb-4">
                  <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">All Tasks</h6>
                  </div>
                  <div class="card-body">
                    <div class="table-responsive">
                      <table
                        class="table table-bordered"
                        id="taskTable"
                        width="100%"
                        cellspacing="0"
                      >
                        <thead>
                          <tr>
                            <th>Task</th>
                            <th>Project</th>
                            <th>Priority</th>
                            <th>Status</th>
                            <th>Due Date</th>
                            <th>Assigned To</th>
                            <th>Notes</th>
                            <th>Actions</th>
                          </tr>
                        </thead>
                        <tbody id="taskTableBody">
                          <!-- Tasks will be dynamically added here -->
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- /.container-fluid -->
        </div>
        <!-- End of Main Content -->

        <!-- Footer -->
        <footer class="sticky-footer bg-white">
          <div class="container my-auto">
            <div class="copyright text-center my-auto">
              <span>Copyright &copy; Collaborative System 2023</span>
            </div>
          </div>
        </footer>
        <!-- End of Footer -->
      </div>
      <!-- End of Content Wrapper -->
    </div>
    <!-- End of Page Wrapper -->

    <!-- Create Task Modal -->
    <div
      class="modal fade"
      id="createTaskModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="createTaskModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="createTaskModalLabel">
              Create New Task
            </h5>
            <button
              class="close"
              type="button"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">×</span>
            </button>
          </div>
          <div class="modal-body">
            <form id="taskForm">
              <div class="form-group">
                <label for="taskTitle">Task Title</label>
                <input
                  type="text"
                  class="form-control"
                  id="taskTitle"
                  placeholder="Enter task title"
                  required
                />
              </div>
              <div class="form-group">
                <label for="taskDescription">Description</label>
                <textarea
                  class="form-control"
                  id="taskDescription"
                  rows="3"
                  placeholder="Enter task description"
                ></textarea>
              </div>
              <div class="form-row">
                <div class="form-group col-md-6">
                  <label for="taskProject">Project</label>
                  <select id="taskProject" class="form-control" required>
                    <option value="" selected disabled>Choose...</option>
                    <option>Website Redesign</option>
                    <option>Collaborative System</option>
                    <option>API Development</option>
                    <option>Performance Tuning</option>
                  </select>
                </div>
                <div class="form-group col-md-6">
                  <label for="taskPriority">Priority</label>
                  <select id="taskPriority" class="form-control" required>
                    <option value="" selected disabled>Choose...</option>
                    <option>Low</option>
                    <option>Medium</option>
                    <option>High</option>
                  </select>
                </div>
              </div>
              <div class="form-row">
                <div class="form-group col-md-6">
                  <label for="taskAssignee">Assign To</label>
                  <textarea
                    class="form-control"
                    id="taskAssignee"
                    rows="2"
                    placeholder="Enter assignee names"
                  ></textarea>
                </div>
                <div class="form-group col-md-6">
                  <label for="taskDueDate">Due Date</label>
                  <input
                    type="date"
                    class="form-control"
                    id="taskDueDate"
                    required
                  />
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              class="btn btn-secondary"
              type="button"
              data-dismiss="modal"
            >
              Cancel
            </button>
            <button class="btn btn-primary" type="button" id="createTaskBtn">
              Create Task
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Note Modal -->
    <div
      class="modal fade"
      id="noteModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="noteModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="noteModalLabel">Add Note</h5>
            <button
              class="close"
              type="button"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">×</span>
            </button>
          </div>
          <div class="modal-body">
            <textarea
              class="form-control note-textarea"
              id="noteText"
              placeholder="Enter your note here..."
            ></textarea>
          </div>
          <div class="modal-footer">
            <button
              class="btn btn-secondary"
              type="button"
              data-dismiss="modal"
            >
              Cancel
            </button>
            <button class="btn btn-primary" type="button" id="saveNoteBtn">
              Save Note
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap core JavaScript-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="js/sb-admin-2.min.js"></script>

    <script>
      // Task data and counters
      let tasks = [];
      let taskIdCounter = 0;
      let currentTaskForNote = null;

      // Initialize the page
      $(document).ready(function () {
        updateTaskCounters();

        // Task filter functionality
        $('input[name="statusFilter"]').change(function () {
          const filter = $(this).attr("id");
          filterTasks(filter);
        });

        // Create task button handler
        $("#createTaskBtn").click(function () {
          createTask();
        });

        // Save note button handler
        $("#saveNoteBtn").click(function () {
          saveNote();
        });
      });

      // Create a new task
      function createTask() {
        const title = $("#taskTitle").val();
        const description = $("#taskDescription").val();
        const project = $("#taskProject").val();
        const priority = $("#taskPriority").val();
        const assignee = $("#taskAssignee").val();
        const dueDate = $("#taskDueDate").val();

        if (!title || !project || !priority || !dueDate) {
          alert("Please fill in all required fields");
          return;
        }

        const newTask = {
          id: taskIdCounter++,
          title: title,
          description: description,
          project: project,
          priority: priority,
          status: "todo",
          dueDate: dueDate,
          assignee: assignee,
          note: "",
        };

        tasks.push(newTask);
        renderTasks();
        updateTaskCounters();

        // Reset form and close modal
        $("#taskForm")[0].reset();
        $("#createTaskModal").modal("hide");
      }

      // Render all tasks in the table
      // Render all tasks in the table
      function renderTasks() {
        const taskTableBody = $("#taskTableBody");
        taskTableBody.empty();

        tasks.forEach((task) => {
          const priorityClass = `priority-${task.priority.toLowerCase()}`;
          const statusClass = `status-${task.status}`;

          const row = `
      <tr class="${priorityClass} ${statusClass}" data-task-id="${task.id}">
        <td>
          <div class="font-weight-bold">${task.title}</div>
          <div class="small text-gray-500">${task.description}</div>
        </td>
        <td><a href="project.html" class="text-primary">${task.project}</a></td>
        <td><span class="badge badge-${getPriorityBadgeClass(task.priority)}">${
            task.priority
          }</span></td>
        <td><span class="badge badge-${getStatusBadgeClass(
          task.status
        )}">${formatStatus(task.status)}</span></td>
        <td>${task.dueDate}</td>
        <td>${task.assignee}</td>
        <td>
          <div class="note-display" data-task-id="${task.id}">
            ${task.note || '<span class="text-muted">No notes</span>'}
          </div>
        </td>
        <td>
          <button class="btn btn-sm btn-success complete-task" data-task-id="${
            task.id
          }">
            <i class="fas fa-check"></i>
          </button>
          <button class="btn btn-sm btn-danger delete-task" data-task-id="${
            task.id
          }">
            <i class="fas fa-trash"></i>
          </button>
          <button class="btn btn-sm btn-info add-note" data-task-id="${
            task.id
          }">
            <i class="fas fa-sticky-note"></i>
          </button>
        </td>
      </tr>
    `;

          taskTableBody.append(row);
        });

        // ... rest of the event handlers remain the same
      }

      // Complete a task (mark as done)
      function completeTask(taskId) {
        const taskIndex = tasks.findIndex((task) => task.id === taskId);
        if (taskIndex !== -1) {
          tasks[taskIndex].status = "done";
          renderTasks();
          updateTaskCounters();
        }
      }

      // Delete a task
      function deleteTask(taskId) {
        tasks = tasks.filter((task) => task.id !== taskId);
        renderTasks();
        updateTaskCounters();
      }

      // Open note modal for a task
      function openNoteModal(taskId) {
        currentTaskForNote = taskId;
        const task = tasks.find((task) => task.id === taskId);
        $("#noteText").val(task.note || "");
        $("#noteModal").modal("show");
      }

      // Save note for a task
      function saveNote() {
        if (currentTaskForNote !== null) {
          const taskIndex = tasks.findIndex(
            (task) => task.id === currentTaskForNote
          );
          if (taskIndex !== -1) {
            tasks[taskIndex].note = $("#noteText").val();
            renderTasks();
            $("#noteModal").modal("hide");
            currentTaskForNote = null;
          }
        }
      }

      // Filter tasks by status
      function filterTasks(filter) {
        if (filter === "all") {
          $("tr[data-task-id]").show();
        } else {
          $("tr[data-task-id]").hide();
          $(`.status-${filter}`).show();
        }
      }

      // Update task counters
      function updateTaskCounters() {
        const totalTasks = tasks.length;
        const completedTasks = tasks.filter(
          (task) => task.status === "done"
        ).length;
        const inProgressTasks = tasks.filter(
          (task) => task.status === "inprogress"
        ).length;
        const overdueTasks = tasks.filter((task) => {
          if (task.status === "done") return false;
          const dueDate = new Date(task.dueDate);
          const today = new Date();
          return dueDate < today;
        }).length;

        $("#totalTasks").text(totalTasks);
        $("#completedTasks").text(completedTasks);
        $("#inProgressTasks").text(inProgressTasks);
        $("#overdueTasks").text(overdueTasks);
      }

      // Helper functions
      function getPriorityBadgeClass(priority) {
        switch (priority.toLowerCase()) {
          case "high":
            return "danger";
          case "medium":
            return "warning";
          case "low":
            return "success";
          default:
            return "secondary";
        }
      }

      function getStatusBadgeClass(status) {
        switch (status) {
          case "todo":
            return "secondary";
          case "inprogress":
            return "primary";
          case "review":
            return "warning";
          case "done":
            return "success";
          default:
            return "secondary";
        }
      }

      function formatStatus(status) {
        switch (status) {
          case "todo":
            return "To Do";
          case "inprogress":
            return "In Progress";
          case "review":
            return "Review";
          case "done":
            return "Done";
          default:
            return status;
        }
      }
    </script>
  </body>
</html>
